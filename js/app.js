(function(){function a(a=!0){a&&!l()?q.style.removeProperty("display"):q.style.display="none"}function b(){var a=document.body.clientHeight,b=n.scrollHeight,c=o.scrollHeight;if(b>c){o.style.height=`${b+a/2}px`}else""===o.style.height&&(o.style.height=`${a}px`)}function c(){var a=localStorage.getItem(r)||"";return a}function d(a){return a.startsWith("note-")?a:"note-"+a}function e(){var a=c();n.value=a,b()}function f(a){u.has("note")&&k(a,u.get("note"),function(){v=a})}function g(a){return clearTimeout(t),t=setTimeout(function(){f(a)},5000),localStorage.setItem(r,a)}function h(a,b){return Math.floor(Math.random()*(b-a+1))+a}function i(a){var b=h(1,255);a?p.style.backgroundColor="hsl("+b+", 100%, 50%)":p.style.removeProperty("background-color")}function j(a,b=null){null===b&&(b=Math.random().toString(36).substr(5,15)),b.startsWith("note-")&&(b=b.replace("note-",""));var c={};return c["note-"+b]=a,c}function k(a,b,c){if(v===a)return!0;if(l())return!0;i(!0);var d=j(a,b);fetch(s+".json",{method:"PATCH",body:JSON.stringify(d)}).then(function(a){return i(!1),a.json()}).then(function(b){if(v=a,"function"==typeof c)return c(b,d)})}function l(){return u.has("readonly")||u.has("msar")}function m(a){return!!l()||void fetch(s+"/"+d(a)+".json",{method:"DELETE"}).then(a=>a.json()).then(a=>{console.log(a)})}const n=document.getElementById("editor"),o=document.getElementById("editor-container"),p=document.getElementById("save"),q=document.getElementById("delete"),r="__msar_note_app",s="seton/moc.oiesaberif.em-rasm//:sptth".split("").reverse().join("");var t,u=new URLSearchParams(window.location.search),v="";n.onkeyup=function(a){g(a.target.value),b()},n.onkeydown=function(){clearTimeout(t)},q.onclick=function(){var b=confirm("Do you really want to delete?");if(b&&u.has("note")){m(u.get("note")),a(!1);var c=new URL(location.origin+location.pathname);window.history.pushState("","Note",c),u=new URLSearchParams(window.location.search)}},p.onclick=function(){var b=c();if(!b)return alert("Write something..."),0;var d=k(b,u.get("note")||null,function(b,c){if(null!==b){var d=Object.keys(c)[0],e=new URL(location.origin+location.pathname);e.searchParams.append("note",d.replace("note-",""));var f=prompt("Here is your note link:",e.toString());clearTimeout(t),f&&(window.history.pushState("","Note",f),u=new URLSearchParams(window.location.search),a(!0))}});if(!0===d)prompt("Here is your note link:",window.location.href)},u.has("note")?(function(a,b){if(a.startsWith("note-")||(a="note-"+a),a)fetch(s+"/"+a+".json").then(function(a){return a.json()}).then(function(a){if("function"==typeof b)return b(a)});else if("function"==typeof b)return b(!1)}(u.get("note"),function(c){null===c?e():(v=c,n.value=c,g(c),a(!0),b())}),l()&&(n.readOnly=!0,p.style.display="none",q.style.display="none")):e()})();